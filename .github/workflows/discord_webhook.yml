name: Discord Notification

on:
  pull_request:
    types: [opened, reopened]
  push:
    branches:
      - main

env:
  DISCORD_SERVER_ID: ${{ secrets.DISCORD_SERVER_ID }}
  DISCORD_WEBHOOK_ID: ${{ secrets.DISCORD_WEBHOOK_ID }}

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send Discord Notification for PR
        if: ${{ github.event_name == 'pull_request' }}
        run: |
          curl \
            -X POST \
            -H "Content-Type: application/json" \
            -d '{
              "content": "ğŸ“¢ æ–°ã—ã„ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒä½œæˆã•ã‚Œã¾ã—ãŸï¼",
              "embeds": [
                {
                  "title": "ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆ #'${{ github.event.number }}': ${{ github.event.pull_request.title }}",
                  "url": "${{ github.event.pull_request.html_url }}",
                  "description": "ä½œæˆè€…: ${{ github.event.pull_request.user.login }}",
                  "color": 0x6ab7ff
                }
              ]
            }' \
            https://discord.com/api/webhooks/${{ env.DISCORD_SERVER_ID }}/${{ env.DISCORD_WEBHOOK_ID }}

      - name: Send Discord Notification for Push/Merge
        if: ${{ github.event_name == 'push' }}
        run: |
          curl \
            -X POST \
            -H "Content-Type: application/json" \
            -d '{
              "content": "âœ… ãƒ¡ã‚¤ãƒ³ãƒ–ãƒ©ãƒ³ãƒã«ãƒãƒ¼ã‚¸ã•ã‚Œã¾ã—ãŸï¼",
              "embeds": [
                {
                  "title": "ãƒ¡ã‚¤ãƒ³ãƒ–ãƒ©ãƒ³ãƒæ›´æ–°",
                  "url": "${{ github.event.compare }}",
                  "description": "æœ€æ–°ã®ã‚³ãƒŸãƒƒãƒˆ: ${{ github.event.head_commit.message }}",
                  "color": 0x82ff92
                }
              ]
            }' \
            https://discord.com/api/webhooks/${{ env.DISCORD_SERVER_ID }}/${{ env.DISCORD_WEBHOOK_ID }}

